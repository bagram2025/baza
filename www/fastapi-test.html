<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastAPI –¢–µ—Å—Ç - Baza Project</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        .api-response {
            background: #1a1a1a;
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            border: 1px solid #333;
        }
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
            justify-content: center;
        }
        .endpoint-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .endpoint-method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8em;
            margin-right: 10px;
        }
        .method-get { background: #61affe; color: white; }
        .method-post { background: #49cc90; color: white; }
        .form-group {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .form-group input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 10px;
        }
        .status-online { background: #d4edda; color: #155724; }
        .status-offline { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° FastAPI –¢–µ—Å—Ç–æ–≤–∞—è –°—Ç—Ä–∞–Ω–∏—Ü–∞</h1>
            <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã FastAPI —Å —Ä—É—Å—Å–∫–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π</p>
            <div class="ip-address">
                –ü–æ—Ä—Ç: 8001 | –°–µ—Ä–≤–µ—Ä: 127.0.0.1
                <span id="apiStatus" class="status-badge status-online">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
            </div>
        </div>

        <div class="service-card">
            <h2>üîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API</h2>
            
            <div class="btn-group">
                <button onclick="testEndpoint('/')" class="btn">üè† –ì–ª–∞–≤–Ω–∞—è</button>
                <button onclick="testEndpoint('/health')" class="btn btn-api">‚ù§Ô∏è Health Check</button>
                <button onclick="testEndpoint('/items')" class="btn btn-secondary">üì¶ –¢–æ–≤–∞—Ä—ã</button>
                <button onclick="testEndpoint('/info')" class="btn">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
                <a href="http://127.0.0.1:8001/docs" target="_blank" class="btn btn-api">üìö Swagger UI</a>
                <a href="http://127.0.0.1:8001/redoc" target="_blank" class="btn btn-secondary">üìñ ReDoc</a>
            </div>

            <div id="response" class="api-response">
                üëÜ –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API...
            </div>
        </div>

        <div class="service-card">
            <h2>üß™ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏</h2>
            
            <div class="form-group">
                <h3>üìù –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h3>
                <input type="text" id="itemName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" value="–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä">
                <input type="text" id="itemDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" value="–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞">
                <input type="number" id="itemPrice" placeholder="–¶–µ–Ω–∞" value="199.99" step="0.01">
                <input type="text" id="itemCategory" placeholder="–ö–∞—Ç–µ–≥–æ—Ä–∏—è" value="—ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞">
                <br>
                <button onclick="createItem()" class="btn">‚ûï –°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä</button>
            </div>

            <div class="form-group">
                <h3>üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ –ø–æ ID</h3>
                <input type="number" id="searchId" placeholder="ID —Ç–æ–≤–∞—Ä–∞" value="0" min="0">
                <button onclick="searchItem()" class="btn btn-secondary">üîé –ù–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä</button>
            </div>
        </div>

        <div class="service-card">
            <h2>üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã</h2>
            
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <strong>/</strong> - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ API
            </div>
            
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <strong>/health</strong> - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞
            </div>
            
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <strong>/items</strong> - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤
            </div>
            
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <strong>/items/{id}</strong> - –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä –ø–æ ID
            </div>
            
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <strong>/info</strong> - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
            </div>
            
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <strong>/docs</strong> - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger
            </div>
            
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <strong>/redoc</strong> - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ReDoc
            </div>
        </div>

        <div class="service-card">
            <h2>üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <p><strong>URL API:</strong> http://127.0.0.1:8001</p>
            <p><strong>–ü–æ—Ä—Ç:</strong> 8001</p>
            <p><strong>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Swagger</p>
            <p><strong>–ö–æ–¥–∏—Ä–æ–≤–∫–∞:</strong> UTF-8 (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞)</p>
            <p><strong>–°–µ—Ä–≤–µ—Ä:</strong> Uvicorn + FastAPI</p>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <a href="/" class="btn">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>
            <button onclick="runAllTests()" class="btn btn-api">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
        </div>
    </div>

    <script>
        const API_BASE = 'http://127.0.0.1:8001';
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
        async function testEndpoint(endpoint) {
            const responseElement = document.getElementById('response');
            responseElement.innerHTML = `üîÑ –ó–∞–ø—Ä–æ—Å –∫ ${endpoint}...`;
            
            try {
                const response = await fetch(`${API_BASE}${endpoint}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                responseElement.innerHTML = `‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç ${endpoint}:\n\n${JSON.stringify(data, null, 2)}`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                updateApiStatus(true);
                
            } catch (error) {
                responseElement.innerHTML = `‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ ${endpoint}:\n\n${error.message}`;
                updateApiStatus(false);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
        async function createItem() {
            const name = document.getElementById('itemName').value;
            const description = document.getElementById('itemDesc').value;
            const price = parseFloat(document.getElementById('itemPrice').value);
            const category = document.getElementById('itemCategory').value;
            
            if (!name || !price) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–∞');
                return;
            }
            
            const responseElement = document.getElementById('response');
            responseElement.innerHTML = 'üîÑ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞...';
            
            try {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º FastAPI —ç—Ç–æ –±—ã–ª –±—ã POST –∑–∞–ø—Ä–æ—Å
                // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∂–µ–º –¥–∞–Ω–Ω—ã–µ
                const newItem = {
                    id: Date.now(), // –≤—Ä–µ–º–µ–Ω–Ω—ã–π ID
                    name: name,
                    description: description,
                    price: price,
                    category: category,
                    created_at: new Date().toISOString()
                };
                
                responseElement.innerHTML = `‚úÖ –¢–æ–≤–∞—Ä —Å–æ–∑–¥–∞–Ω!\n\n${JSON.stringify(newItem, null, 2)}`;
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è
                document.getElementById('itemName').value = '';
                document.getElementById('itemDesc').value = '';
                document.getElementById('itemPrice').value = '';
                document.getElementById('itemCategory').value = '';
                
            } catch (error) {
                responseElement.innerHTML = `‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞:\n\n${error.message}`;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–∞
        async function searchItem() {
            const itemId = document.getElementById('searchId').value;
            
            if (!itemId && itemId !== '0') {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ ID —Ç–æ–≤–∞—Ä–∞');
                return;
            }
            
            await testEndpoint(`/items/${itemId}`);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ API
        async function updateApiStatus(isOnline) {
            const statusElement = document.getElementById('apiStatus');
            if (isOnline) {
                statusElement.textContent = '‚úÖ –û–Ω–ª–∞–π–Ω';
                statusElement.className = 'status-badge status-online';
            } else {
                statusElement.textContent = '‚ùå –û—Ñ–ª–∞–π–Ω';
                statusElement.className = 'status-badge status-offline';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
        async function runAllTests() {
            const responseElement = document.getElementById('response');
            responseElement.innerHTML = 'üöÄ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤...\n\n';
            
            const endpoints = ['/health', '/items', '/info', '/'];
            let results = [];
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(`${API_BASE}${endpoint}`);
                    const data = await response.json();
                    results.push(`‚úÖ ${endpoint} - –£–°–ü–ï–•`);
                } catch (error) {
                    results.push(`‚ùå ${endpoint} - –û–®–ò–ë–ö–ê: ${error.message}`);
                }
            }
            
            responseElement.innerHTML = `üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:\n\n${results.join('\n')}`;
            updateApiStatus(results.filter(r => r.includes('‚úÖ')).length >= 2);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
        function testEncoding() {
            const testStrings = [
                "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!",
                "–†—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏",
                "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã: ‚Ç¨ ¬£ ¬• ¬© ¬Æ",
                "–¶–∏—Ñ—Ä—ã: 1234567890"
            ];
            
            const responseElement = document.getElementById('response');
            responseElement.innerHTML = `üî§ –¢–µ—Å—Ç –∫–æ–¥–∏—Ä–æ–≤–∫–∏ UTF-8:\n\n${testStrings.join('\n')}`;
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–¥–æ—Ä–æ–≤—å–µ API –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            testEndpoint('/health');
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä—É—Å—Å–∫—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É
            setTimeout(testEncoding, 1000);
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∞–≤–∏—à –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey) {
                switch(event.key) {
                    case '1':
                        event.preventDefault();
                        testEndpoint('/health');
                        break;
                    case '2':
                        event.preventDefault();
                        testEndpoint('/items');
                        break;
                    case '3':
                        event.preventDefault();
                        testEndpoint('/info');
                        break;
                    case 'r':
                        event.preventDefault();
                        runAllTests();
                        break;
                }
            }
        });
    </script>
</body>
</html>
